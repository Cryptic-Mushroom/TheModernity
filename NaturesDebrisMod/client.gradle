/*
 * Copyright (c) 2020 RedGalaxy & contributors
 * All rights reserved. Do not distribute.
 *
 * For a full license, see LICENSE.txt
 */

task clientJar(type: Jar) {
    from "${project.buildDir}/classes/java/main"
    from "${project.buildDir}/resources/main"
    from configurations.embed.collect { it.isDirectory() ? it : zipTree( it ) }

    manifest {
        attributes( [
            "Specification-Title"     : "Nature's Debris",
            "Specification-Vendor"    : "Shadew",
            "Specification-Version"   : "${ version }",
            "Implementation-Title"    : project.ext.implName,
            "Implementation-Version"  : "${ version }",
            "Implementation-Vendor"   : "Shadew",
            "Implementation-Timestamp": new Date().format( "yyyy-MM-dd'T'HH:mm:ssZ" )
        ] )
    }

    appendix = "client"

    exclude( "natures/debris/server/**" )
}

task signClientJar( dependsOn: 'reobfClientJar' ) {
    doLast {
        project.ext.sign( clientJar.archivePath )
    }
}

def reobfClientJar = project.reobf.create('clientJar')
reobfClientJar.dependsOn('createMcpToSrg')
reobfClientJar.setMappings(tasks.createMcpToSrg.getOutput())

project.shade.create("clientJar")
